import pandas as pd
import os

# --- Load the dataset ---
file_path = "/content/amazon_review.csv"

# Check if the file exists
if not os.path.exists(file_path):
    print(f"Error: The file '{file_path}' was not found.")
    print("Please ensure the file is uploaded to your Colab environment.")
    print("You can upload it by clicking the 'Files' icon on the left sidebar, then 'Upload to session storage'.")
    print("Alternatively, if your file is in Google Drive, you can mount your Drive:")
    print("from google.colab import drive")
    print("drive.mount('/content/drive')")
    print("Then update 'file_path' to point to its location in Drive (e.g., '/content/drive/MyDrive/amazon_review.csv').")
else:
    df = None
    common_separators = [',', ';', '\t', '|'] # Common delimiters including pipe
    encodings = ["utf-8", "latin1"]

    for encoding in encodings:
        for sep in common_separators:
            try:
                print(f"Attempting to read with encoding='{encoding}' and sep='{sep}'...")
                # Try reading without specifying 'sep' if it's the default comma, otherwise with explicit 'sep'
                if sep == ',':
                    df = pd.read_csv(file_path, encoding=encoding)
                else:
                    df = pd.read_csv(file_path, encoding=encoding, sep=sep)
                print(f"Successfully read with encoding='{encoding}' and sep='{sep}'.")
                break # Break out of separator loop if successful
            except (UnicodeDecodeError, pd.errors.ParserError) as e:
                print(f"Failed with encoding='{encoding}' and sep='{sep}': {type(e).__name__} - {e}")
                continue # Try next separator
            except Exception as e:
                print(f"An unexpected error occurred with encoding='{encoding}' and sep='{sep}': {type(e).__name__} - {e}")
                continue # Try next separator
        if df is not None:
            break # Break out of encoding loop if df is loaded

    if df is None:
        print("Failed to read the CSV file with any tried separator and encoding combination.")
        print("Please check the file's delimiter and encoding manually.")
    else:
        # --- Display basic dataset info ---
        print("\nFIRST 5 ROWS:")
        print(df.head(), "\n")

        print("DATASET INFO:")
        print(df.info(), "\n")

        print("SUMMARY STATISTICS (NUMERIC COLUMNS):")
        print(df.describe(), "\n")

        print("COLUMN NAMES:")
        print(df.columns)
